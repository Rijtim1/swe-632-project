<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Metadata and external stylesheets -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Pomodoro Timer to boost productivity with focus and break sessions." />
  <title>Pomodoro Timer</title>
  <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css" />
  <link rel="stylesheet" href="styles.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />
</head>

<body>
  <div class="w3-container">
    <!-- Main heading -->
    <header>
      <h1 class="w3-center w3-text-white">Pomodoro Timer</h1>
    </header>

    <!-- Help Modal Button -->
    <button class="w3-button w3-blue w3-margin" onclick="toggleModal('helpModal', true)"
      title="Open the help modal to learn how to use the Pomodoro Timer effectively" aria-controls="helpModal">
      <i class="w3-margin-right" aria-hidden="true">ℹ️</i>How it Works?
    </button>

    <!-- Help Modal -->
    <div id="helpModal" class="w3-modal" role="dialog" aria-labelledby="helpModalTitle" aria-hidden="true">
      <div class="w3-modal-content w3-padding">
        <!-- Close button for Help Modal -->
        <span onclick="toggleModal('helpModal', false)" class="w3-button w3-display-topright"
          aria-label="Close Help Modal">&times;</span>
        <!-- Help Modal Content -->
        <h2 id="helpModalTitle">How to Use the Pomodoro Timer</h2>
        <p><strong>Focus Time:</strong> Work without distractions.</p>
        <p>
          <strong>Break Time:</strong> Take a short rest before resuming work.
        </p>
        <p>
          Use the sliders to adjust focus and break durations. The timer will
          transition automatically.
        </p>
        <p>
          Alternatively, use the presets to quickly set focus and break
          durations.
        </p>
        <p>
          Press <strong>"Start"</strong> to begin your session. Stay
          productive!
        </p>
        <p>
          Use the <strong>"Skip Phase"</strong> button to jump directly to the next phase (focus or break) without waiting for the current phase to end.
        </p>
      </div>
    </div>

    <!-- Settings Button -->
    <button class="w3-button w3-blue w3-margin" onclick="toggleModal('settingsModal', true)"
      title="Open the settings modal to configure timer preferences, notifications, and presets"
      aria-controls="settingsModal">
      <i class="w3-margin-right" aria-hidden="true">⚙️</i>Settings
    </button>

    <!-- Settings Modal -->
    <div id="settingsModal" class="w3-modal" role="dialog" aria-labelledby="settingsModalTitle" aria-hidden="true">
      <div class="w3-modal-content w3-padding">
        <!-- Close button for Settings Modal -->
        <span onclick="toggleModal('settingsModal', false)" class="w3-button w3-display-topright"
          aria-label="Close Settings Modal">&times;</span>
        <!-- Settings Modal Content -->
        <h2 id="settingsModalTitle">Settings</h2>
        <!-- Audio Notification Toggle -->
        <label class="w3-text-black">
          Audio Notification:
          <label class="switch" aria-label="Enable or disable audio notifications">
            <input type="checkbox" id="audioToggle" onchange="toggleAudioSetting()"
              title="Toggle audio notification on or off" />
            <span class="slider round"></span>
          </label>
        </label>
        <div id="audioStatus" class="w3-text-gray w3-small" aria-live="polite">
          Audio notifications are disabled.
        </div>

        <h3>Timer Settings</h3>
        <div class="w3-section">
          <label class="w3-text-black">Focus Time (1–120 minutes):</label>
          <div class="slider-container">
            <button class="w3-button w3-small w3-gray" onclick="adjustTime('focus', -5)"
              title="Decrease focus time by 5 minutes">
              - 5 min
            </button>

            <input type="number" id="focusTimeInput" min="1" max="120" value="25" class="w3-input w3-border"
              style="width: 70px" oninput="syncSliderWithInput('focus')" title="Manually enter focus time" /> min

            <input type="range" id="focusTime" class="w3-input w3-border" min="1" max="120" value="25"
              oninput="syncInputWithSlider('focus')" />

            <button class="w3-button w3-small w3-gray" onclick="adjustTime('focus', 5)"
              title="Increase focus time by 5 minutes">
              + 5 min
            </button>
          </div>
        </div>

        <div class="w3-section">
          <label class="w3-text-black">Break Time (1–60 minutes):</label>
          <div class="slider-container">
            <button class="w3-button w3-small w3-gray" onclick="adjustTime('break', -5)"
              title="Decrease break time by 5 minutes">
              - 5 min
            </button>

            <input type="number" id="breakTimeInput" min="1" max="60" value="5" class="w3-input w3-border"
              style="width: 70px" oninput="syncSliderWithInput('break')" title="Manually enter break time" /> min

            <input type="range" id="breakTime" class="w3-input w3-border" min="1" max="60" value="5"
              oninput="syncInputWithSlider('break')" />

            <button class="w3-button w3-small w3-gray" onclick="adjustTime('break', 5)"
              title="Increase break time by 5 minutes">
              + 5 min
            </button>
          </div>
        </div>

        <div id="notificationSettings" class="notification-settings"></div>

        <h3>Presets (Focus/Break)</h3>
        <div class="w3-margin-top">
          <!-- Preset Buttons -->
          <button class="w3-button w3-light-gray" onclick="setPreset(5, 1)"
            title="Set focus time to 5 minutes and break time to 1 minute">
            5m/1m
          </button>
          <button class="w3-button w3-light-gray" onclick="setPreset(25, 5)"
            title="Set focus time to 25 minutes and break time to 5 minutes">
            25m/5m
          </button>
          <button class="w3-button w3-light-gray" onclick="setPreset(50, 10)"
            title="Set focus time to 50 minutes and break time to 10 minutes">
            50m/10m
          </button>
          <button class="w3-button w3-light-gray" onclick="setPreset(90, 15)"
            title="Set focus time to 90 minutes and break time to 15 minutes">
            90m/15m
          </button>
        </div>

        <div class="w3-section w3-center">
          <button class="w3-button w3-red w3-margin-top" onclick="toggleModal('settingsModal', false)">
            Close
          </button>
        </div>
      </div>
    </div>

    <!-- Timer Section -->
    <main class="w3-card w3-padding w3-center">
      <section>
        <!-- Status Message -->
        <div id="statusMessage" class="status-message" aria-live="polite">
          <i class="fas fa-info-circle"></i> Press Start to begin your session.
        </div>
        <!-- Timer Display -->
        <div class="timer-container w3-animate-zoom" role="timer" aria-live="polite">
          <svg class="progress-ring" width="300" height="300" aria-hidden="true">
            <circle class="progress-ring__background" cx="150" cy="150" r="120" />
            <circle class="progress-ring__circle" cx="150" cy="150" r="120" />
          </svg>
          <div id="timer">25:00</div>
        </div>
        <!-- Pause Indicator -->
        <div id="pauseIndicator" class="w3-text-gray w3-large" style="display: none;">
          Timer Paused
        </div>
        <!-- Timer Controls -->
        <div class="timer-controls">
          <div class="primary-action">
            <button id="startPauseButton" onclick="toggleTimer()" class="w3-button w3-green" title="Start or pause the timer">
              <i class="fas fa-play"></i> Start
            </button>
          </div>
          <hr class="divider" />
          <div class="secondary-actions">
            <button onclick="confirmReset()" class="w3-button w3-gray" title="Reset the timer">
              <i class="fas fa-redo"></i> Reset
            </button>
            <button onclick="skipPhase()" class="w3-button w3-orange" title="Skip the current phase">
              <i class="fas fa-forward"></i> Skip Phase
            </button>
          </div>
        </div>
      </section>

      <!-- Cycle Tracking Section -->
      <section id="cycleTracking" class="w3-section" aria-labelledby="cycleTrackingTitle">
        <h3 id="cycleTrackingTitle" class="w3-center w3-text-blue">
          Cycle Tracking
          <button class="w3-button w3-small w3-blue w3-margin-left w3-tooltip" onclick="toggleModal('cycleModal', true)" 
            title="Learn more about cycles and how they are tracked" aria-controls="cycleModal">
            <i class="fas fa-info-circle"></i> Learn More
            <span class="w3-text w3-tag w3-light-gray w3-small w3-round w3-tooltip-content">
              Click to learn about cycles and their importance in productivity tracking.
            </span>
          </button>
        </h3>
        <div class="w3-row-padding">
          <div class="w3-third w3-padding-small">
            <div class="w3-card w3-padding w3-center w3-light-gray w3-round">
              <h4 class="w3-medium">
                Completed Cycles
              </h4>
              <p class="w3-xxlarge w3-text-green">
                <span id="cycleCount">0</span>
              </p>
            </div>
          </div>
          <div class="w3-third w3-padding-small">
            <div class="w3-card w3-padding w3-center w3-light-gray w3-round">
              <h4 class="w3-medium">
                Focus Sessions
              </h4>
              <p class="w3-xxlarge w3-text-blue"><span id="focusCount">0</span></p>
            </div>
          </div>
          <div class="w3-third w3-padding-small">
            <div class="w3-card w3-padding w3-center w3-light-gray w3-round">
              <h4 class="w3-medium">
                Break Sessions
              </h4>
              <p class="w3-xxlarge w3-text-orange"><span id="breakCount">0</span></p>
            </div>
          </div>
        </div>
      </section>

      <!-- Cycle Explanation Modal -->
      <div id="cycleModal" class="w3-modal" role="dialog" aria-labelledby="cycleModalTitle" aria-hidden="true">
        <div class="w3-modal-content w3-padding">
          <!-- Close button for Cycle Modal -->
          <span onclick="toggleModal('cycleModal', false)" class="w3-button w3-display-topright" 
            aria-label="Close Cycle Modal">&times;</span>
          <!-- Cycle Modal Content -->
          <h2 id="cycleModalTitle">What is a Cycle?</h2>
          <p>
            A <strong>cycle</strong> consists of one completed focus session followed by one completed break session.
          </p>
          <h3>How Cycle Tracking Works</h3>
          <p>
            The timer tracks the number of completed cycles, focus sessions, and break sessions. These counts are displayed in the
            <strong>Cycle Tracking</strong> section. Use this feature to monitor your productivity and ensure you're taking regular breaks.
          </p>
        </div>
      </div>

      <!-- External Link -->
      <footer>
        <p>
          <a href="https://en.wikipedia.org/wiki/Pomodoro_Technique" target="_blank" rel="noopener noreferrer"
            title="Learn more about the Pomodoro Technique">
            Learn more about the Pomodoro Technique
          </a>
        </p>
      </footer>
    </main>
  </div>

  <!-- Audio Notification -->
  <audio id="transitionSound" preload="auto" aria-hidden="true">
    <source src="ding.mp3" type="audio/mpeg" />
  </audio>
  <!-- External JavaScript -->
  <script src="script.js" defer></script>
</body>

</html>